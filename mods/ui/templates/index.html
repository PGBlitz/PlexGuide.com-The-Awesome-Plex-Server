<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PlexGuide UI: Docker Compose</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <h1>PlexGuide UI: Docker Compose</h1>

    <div id="ymls-content">
        <select id="app-select">
            <option value="">Select Application</option>
        </select>

        <div id="docker-status">
            Docker Status: <span id="status-message"></span>
        </div>

        <textarea id="yml-content" rows="20" cols="80"></textarea>

        <button id="save-btn">Save</button>
        <button id="deploy-btn">Deploy</button>
        <button id="kill-btn">Kill</button>

        <div id="log-box"></div>
    </div>

    <script>
        $(document).ready(function() {
            // Populate the dropdown
            $.get('/get_folders', function(folders) {
                folders.forEach(function(folder) {
                    $('#app-select').append($('<option>', {
                        value: folder,
                        text: folder
                    }));
                });
            });

            // Load YML content when an app is selected
            $('#app-select').change(function() {
                var selectedFolder = $(this).val();
                if (selectedFolder) {
                    $.post('/load_yml', {folder: selectedFolder}, function(data) {
                        $('#yml-content').val(data);
                    });
                }
            });

            // Save YML content
            $('#save-btn').click(function() {
                var selectedFolder = $('#app-select').val();
                var ymlContent = $('#yml-content').val();
                $.post('/save_yml', {folder: selectedFolder, yml_content: ymlContent}, function(data) {
                    alert(data);
                });
            });

            // TODO: Implement Deploy and Kill functionality
        });
    </script>
</body>
</html>